#!/usr/bin/env sh

# compile {filename} [{filename} ...]
# compile all

compile_file () {
    target=$1
    printf "Compiling $target ... "
    cat $target | sed 's/<x>/â–ˆ/g' > ../$target
    echo "Done"
}

if [ $# -eq 0 ]; then
    echo "Empty target, abort"
    exit
fi

while [ $# -gt 0 ]; do
    target=$1

    if [ "=$target" = "=" ]; then
        echo "Empty target, abort"
        exit
    fi

    if [ "=$target" = "=all" ]; then
        for i in $(ls *.rst); do
            echo $i
            if [ "$i" != "template.rst" ]; then
                compile_file $i
            fi
        done
        exit
    fi

    compile_file $target
    shift
done
